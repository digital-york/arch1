
<div class="popup popup_subject">

  <div class="popup_title">Add / Edit Subject</div>

  <div>
    <%= link_to 'Go back to subject list', subjects_path, style: "font-style: italic" %>
  </div>

  <% if @subject_name != nil && @subject_name != '' %>
      <div id="popup_info" class="popup_info" style="display: none; text-align: center">
        '<%= @subject_name %>' has been added / deleted
      </div>
  <% end %>

  <div class="subjects">

    <table style="float: left">
      <%
         @top_level_list.each do |top_level_term|
      %>

          <tr>
            <td class="subjects_level1">
              <%= top_level_term['label'].join %>
            </td>
            <td style="width: 135px; padding: 2px">
              <%= button_to 'Add', new_subject_path, params: {:top_level_id => top_level_term['id'], :up_level_id => top_level_term['id']}, :method => :get, title: 'Add subject to this element', class: 'small_button' %>
              <%= button_to 'Edit', edit_subject_path(top_level_term['id']), params: {:top_level_id => top_level_term['id']}, :method => :get, title: 'Edit subject', style: 'margin-left: 5px', class: 'small_button' %>
              <%= button_to 'Delete', subject_path(top_level_term['id']), params: {:subject_name => top_level_term['label']}, method: 'delete', title: 'Delete subject', class: 'small_button', style: 'margin-left: 5px', :data => {:confirm => "Are you sure you want to delete this top-level subject'?"} %>
            </td>
          </tr>

          <%
             top_level_term[:elements].each do |second_level_term|
          %>
              <tr>
                <td class="subjects_level2">
                  <span style="margin-left: 30px"><%= second_level_term['label'].join %></span></td>
                <td style="padding: 2px">
                  <%= button_to 'Add', new_subject_path, params: {:top_level_id => top_level_term['id'], :up_level_id => second_level_term['id']}, :method => :get, title: 'Add subject to this element', class: 'small_button' %>
                  <%= button_to 'Edit', edit_subject_path(second_level_term['id']), params: {:top_level_id => top_level_term['id']}, :method => :get, title: 'Edit subject', style: 'margin-left: 5px', class: 'small_button' %>
                  <%= button_to 'Delete', subject_path(second_level_term['id']), params: {:top_level_id => top_level_term['id'], :subject_name => second_level_term['label']}, method: 'delete', title: 'Delete subject', class: 'small_button', style: 'margin-left: 5px', :data => {:confirm => "Are you sure you want to delete this top-level subject'?"} %>
                </td>
              </tr>
              <%
                 second_level_term[:elements].each do |third_level_term|
              %>
                  <tr>
                    <td class="subjects_level3">
                      <span style="margin-left: 50px;"><%= third_level_term['label'].join %></span></td>
                    <td style="padding: 2px">
                      <%= button_to 'Add', new_subject_path, params: {:top_level_id => top_level_term['id']}, :method => :get, title: 'N/A', class: 'small_button', disabled: 'true' %>
                      <%= button_to 'Edit', edit_subject_path(third_level_term['id']), params: {:top_level_id => top_level_term['id']}, :method => :get, title: 'Edit subject', style: 'margin-left: 5px', class: 'small_button' %>
                      <%= button_to 'Delete', subject_path(third_level_term['id']), params: {:subject_name => top_level_term['label']}, method: 'delete', title: 'Delete subject', class: 'small_button', style: 'margin-left: 5px', :data => {:confirm => "Are you sure you want to delete this top-level subject'?"} %>
                    </td>
                  </tr>
              <%
                 end
                 end
                 end
              %>
    </table>
  </div>

  <div style="clear: both"></div>

</div>