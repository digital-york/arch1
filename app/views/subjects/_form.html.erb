
<div class="popup popup_subject">

  <%
     if @concept.new_record?
       confirm_text = 'has been added'
       form_url = 'subjects_path(@concept)'
       form_method = ':post'
       if @go_back_id == 'none'
         start_text = 'Add Top-Level'
         go_back_path = 'subjects_path'
       else
         start_text = 'Add'
         go_back_path = 'subject_path(@go_back_id)'
       end
     else
       if @go_back_id == 'none'
         start_text = 'Edit Top-Level'
       else
         start_text = 'Edit'
       end
       confirm_text = 'has been updated'
       form_url = 'subject_path(@concept.id)'
       form_method = ':patch'
       go_back_path = 'subject_path(@go_back_id)'
     end
  %>

  <div class="popup_title">
    <%= start_text %> Subject
  </div>

  <% if @subject_name != nil && @subject_name != '' %>
      <div id="popup_info" class="popup_info" style="display: none; text-align: center">
        '<%= @subject_name %>'
        <%=confirm_text %>
      </div>
  <% end %>

  <% if @error != nil && @error != '' %>
      <div class="popup_error"><%= @error.html_safe %></div>
  <% end %>

  <div>
    <%= link_to 'Go back to list', eval(go_back_path), style: "font-style: italic" %>
  </div>

  <%= form_for @concept, url: eval(form_url), method: eval(form_method), html: {style: 'margin-top: 15px; margin-bottom: 0px'} do |f| %>

      <div class='tab1'>

        <table cellspacing="0" style="width: 100%; font-size: 0.95em">

          <%# Subject Name (preflabel) %>
          <tr>
            <th style="width: 50px">Subject:</th>
            <td>
              <%= text_field_tag "concept[preflabel]", @concept.preflabel %>
            </td>
          </tr>

        </table>

        <%# Submit %>
        <p style="margin-top: 10px">
          <% if @concept.new_record? %>
              <%= f.submit 'Submit' %>
              <%#= f.submit 'Submit and Close' %>
          <% else %>
              <%= f.submit 'Update' %>
          <% end %>
        </p>

        <%= hidden_field_tag 'go_back_id', @go_back_id %>

        <% if @go_back_id == 'none' %>
         <%= hidden_field_tag 'concept[istopconcept][]', 'true' %>
        <% else %>
          <%= hidden_field_tag 'concept[broader][]', @up_level_id %>
        <% end %>
      </div>

      <div style="clear: both"></div>

  <% end %>

</div>
