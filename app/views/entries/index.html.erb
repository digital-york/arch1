<div id='main'>

  <%
    # This instantiates the Terms class (which is used below to dereference ids
    terms = Terms.new('subauthority')
  %>

  <% if session[:folio_id] == '' %>

    <div style="margin-left: 40px; font-size: 1.3em">Please choose a folio from the menubar.</div>

  <% else %>

      <div id='left_frame'>
        <%= render 'image_zoom_small' %>
      </div>

      <div id='right_frame'>

        <% if @entry_list.length == 0 %>
            <div style='float: left; width: 900px; font-size: 1.3em'>There are currently no entries for this folio -
              <%= link_to 'please click here to add a new one', new_entry_path, {:title => 'Create new entry'} %>.
            </div>
            <div style='clear: both'></div>
        <% else %>
            <div id='form'>

              <div class='tab1'>

                <table>

                  <%# Display tabs for entries %>
                  <tr class='noth'>
                    <th colspan='2' id='entry_menu'>
                      <ul>
                        <li style='margin-left: 5px'></li>
                        <% @entry_list.each_with_index do |entry, index| %>
                            <li>
                              <%
                                 str = ''
                                 if @folio_continues_id.to_i == index + 1
                                   str = ' (continues)'
                                 end
                              %>
                              <% if entry.id == @entry.id %>
                                <span class='highlight'>
                                  <span style='color: #9c6b17'>
                                    <%= entry.entry_no + str %>
                                  </span>
                                </span>
                              <% else %>
                                <span class='nohighlight'>
                                  <%= link_to entry.entry_no + str, entry_path(entry) %>
                                </span>
                              <% end %>
                            </li>
                        <% end %>
                        <li>
                          <% if @folio_continues_id == '' %>
                            <span class='nohighlight'>
                              <%= link_to 'New Entry', new_entry_path, {:title => 'Create new entry'} %>
                            </span>
                          <% end %>
                        </li>
                      </ul>
                    </th>
                  </tr>

                  <%# Display Edit and Delete buttons %>
                  <tr>
                    <th colspan='2'>
                        <div class='edit_button'>
						  <%= button_to 'Edit', edit_entry_path(@entry), :method => :get, :class => 'buttonTo' %>
                          <%= button_to 'Delete', entry_path(@entry), :method => :delete, :class => 'buttonTo', :style => 'margin-left: 5px', :data => {:confirm => 'Are you sure you want to delete this entry?'} %>
						</div>
                    </th>
                  </tr>

                  <%# Entry No %>
                  <tr>
                    <th style='width: 153px'>Entry No:</th>
                    <td style='width: 750px'><%= @entry.entry_no %></td>
                  </tr>

                  <%# Entry Type %>
                  <tr>
                    <th style='width: 153px'>Entry Type:</th>
                    <td style='width: 750px'><%= @entry.entry_type %></td>
                  </tr>

                  <%# Continues On %>
                  <% if @is_last_entry == true %>
                      <tr>
                        <th>Continues on next folio:</th>
                        <td>
                          <% if @entry.continues_on != nil && @entry.continues_on != '' %>
                              <%= image_tag 'tick.png' %>
                              &nbsp;&nbsp;<%= link_to 'Discontinue', entry_path(@entry.id, :discontinue => 'true') %>
                          <% end %>
                        </td>
                      </tr>
                  <% end %>

                  <%# Summary %>
                  <tr>
                    <th>Summary:</th>
                    <td>
                      <% @entry.summary.each do |summary| %>
                          <div style="padding: 4px 0px">
                            <%= summary %>
                          </div>
                      <% end %>
                    </td>
                  </tr>

                  <%# Marginalia %>
                  <tr>
                    <th>Marginalia:</th>
                    <td>
                      <% @entry.marginalia.each do |marginalia| %>
                          <div style="padding: 4px 0px">
                            <%= marginalia %>
                          </div>
                      <% end %>
                    </td>
                  </tr>

                  <%# Language %>
                  <tr>
                    <th>Language:</th>
                    <td>
                      <% @entry.language.each do |language| %>
                          <div style="padding: 4px 0px">
                            <% if @entry.language != nil %>
                              <%= terms.get_str_from_id(language, 'preflabel_tesim') %>
                            <% end %>
                          </div>
                      <% end %>
                    </td>
                  </tr>

                  <%# Subject %>
                  <tr>
                    <th>Subject:</th>
                    <td>
                      <% @entry.subject.each do |subject| %>
                          <div style="padding: 4px 0px">
                            <%= terms.get_str_from_id(subject, 'preflabel_tesim') %>
                          </div>
                      <% end %>
                    </td>
                  </tr>

                  <%# Note %>
                  <tr>
                    <th>Note:</th>
                    <td>
                      <% @entry.note.each do |note| %>
                          <div style="padding: 4px 0px">
                            <%= note %>
                          </div>
                      <% end %>
                    </td>
                  </tr>

                  <%# Editorial Note %>
                  <tr>
                    <th>Editorial Note:</th>
                    <td>
                      <% @entry.editorial_note.each do |editorial_note| %>
                          <div style="padding: 4px 0px">
                            <%= editorial_note %>
                          </div>
                      <% end %>
                    </td>
                  </tr>

                  <%# Is Referenced By %>
                  <tr>
                    <th>Is Referenced By:</th>
                    <td>
                      <% @entry.is_referenced_by.each do |is_referenced_by| %>
                          <div style="padding: 4px 0px">
                            <%= is_referenced_by %>
                          </div>
                      <% end %>
                    </td>
                  </tr>

                  <%# Entry Date %>
                  <tr>

                    <th>Date:</th>

                    <td class="tab2">

                      <% @entry.entry_dates.each do |entry_date| %>

                          <div class="field_group">

                            <div class="field_single">

                              <table class="tab3">

                                <tr>
                                  <th>
                                    Date:
                                  </th>
                                  <td>
                                    <div style="min-height: 18px" class="field_group">

                                      <% entry_date.single_dates.each do |single_date| %>

                                          <div class="field_single no_padding">

                                            <table class="tab4" style="border-color: #DCDADA">

                                              <tr>
                                                <th>Date:</th>
                                                <td><%= single_date.date %></td>
                                              </tr>

                                              <tr>
                                                <th style="width: 60px">Certainty:</th>
                                                <td><%= terms.get_str_from_id(single_date.date_certainty, 'preflabel_tesim') %></td>
                                              </tr>
                                              <tr>

                                                <th>Type:</th>
                                                <td><%= terms.get_str_from_id(single_date.date_type, 'preflabel_tesim') %></td>
                                              </tr>
                                            </table>
                                            <div style="clear: both"></div>
                                          </div>
                                      <% end %>

                                    </div>
                                  </td>
                                </tr>

                                <tr>
                                  <th>Date Role:</th>
                                  <td>
                                    <% if entry_date.date_role != nil %>
                                        <%= terms.get_str_from_id(entry_date.date_role, 'preflabel_tesim') %>
                                    <% end %>
                                  </td>
                                </tr>

                                <tr>
                                  <th>Note:</th>
                                  <td>
                                    <%= entry_date.date_note %>
                                  </td>
                                </tr>

                              </table>
                            </div>
                          </div>
                      <% end %>
                    </td>
                  </tr>

                  <%# Related Place %>
                  <tr>

                    <th>Place:</th>

                    <td class="tab2">

                      <% @entry.related_places.each do |related_place| %>

                          <div class="field_group">

                            <div class="field_single">

                              <table class="tab3">

                                <tr>
                                  <th style="width: 110px">*Same As:</th>
                                  <td>
                                    <%= related_place.place_same_as %>
                                  </td>
                                </tr>

                                <tr>
                                  <th>
                                    As Written:
                                  </th>
                                  <td>
                                    <div style="padding: 4px 0px; min-height: 18px" class="field_group">

                                      <% related_place.place_as_written.each do |place_as_written| %>
                                          <div class="field_single">
                                            <%= place_as_written %>
                                          </div>
                                      <% end %>

                                    </div>
                                  </td>
                                </tr>

                                <tr>
                                  <th>
                                    Place Role:
                                  </th>
                                  <td>
                                    <div style="padding: 4px 0px; min-height: 18px" class="field_group">

                                      <% related_place.place_role.each do |place_role| %>
                                          <div class="field_single" style="padding: 4px 0px">
                                            <% if place_role != nil %>
                                                <%= terms.get_str_from_id(place_role, 'preflabel_tesim') %>
                                            <% end %>
                                          </div>
                                      <% end %>

                                    </div>
                                  </td>
                                </tr>

                                <tr>
                                  <th>
                                    Place Type:
                                  </th>
                                  <td>
                                    <div style="padding: 4px 0px; min-height: 18px" class="field_group">

                                      <% related_place.place_type.each do |place_type| %>
                                          <div class="field_single" style="padding: 4px 0px">
                                            <% if place_type != nil %>
                                                <%= terms.get_str_from_id(place_type, 'preflabel_tesim') %>
                                            <% end %>
                                          </div>
                                      <% end %>

                                    </div>
                                  </td>
                                </tr>

                                <tr>
                                  <th>
                                    Note:
                                  </th>
                                  <td>
                                    <div style="padding: 4px 0px; min-height: 18px" class="field_group">

                                      <% related_place.place_note.each do |place_note| %>
                                          <div class="field_single" style="padding: 4px 0px">
                                            <%= place_note %>
                                          </div>
                                      <% end %>

                                    </div>
                                  </td>
                                </tr>

                              </table>
                            </div>

                          </div>
                      <% end %>
                    </td>
                  </tr>

                  <%# Related Person %>
                  <tr>

                    <th>Person:</th>

                    <td class="tab2">

                      <% @entry.related_people.each do |related_person| %>

                          <div class="field_group">

                            <div class="field_single">

                              <table class="tab3">

                                <%# Same As %>
                                <tr>
                                  <th style="width: 110px">*Same As:</th>
                                  <td>
                                    <%= related_person.person_same_as %>
                                  </td>
                                </tr>

                                <%# As Written %>
                                <tr>
                                  <th>
                                    As Written:
                                  </th>
                                  <td>
                                    <div style="padding: 4px 0px; min-height: 18px" class="field_group">

                                      <% related_person.person_as_written.each do |person_as_written| %>
                                          <div class="field_single" style="padding: 4px 0px">
                                            <%= person_as_written %>
                                          </div>
                                      <% end %>

                                    </div>
                                  </td>
                                </tr>

                                <%# Gender %>
                                <tr>
                                  <th>Gender:</th>
                                  <td>
                                    <%= related_person.person_gender %>
                                  </td>
                                </tr>

                                <%# Person Role %>
                                <tr>
                                  <th>
                                    Person Role:
                                  </th>
                                  <td>
                                    <div style="padding: 4px 0px; min-height: 18px" class="field_group">

                                      <% related_person.person_role.each do |person_role| %>
                                          <div class="field_single" style="padding: 4px 0px">
                                            <%= terms.get_str_from_id(person_role, 'preflabel_tesim') %>
                                          </div>
                                      <% end %>

                                    </div>
                                  </td>
                                </tr>

                                <%# Descriptor %>
                                <tr>
                                  <th>*Descriptor:</th>
                                  <td>
                                    <%= terms.get_str_from_id(related_person.person_descriptor, 'preflabel_tesim') %>
                                  </td>
                                </tr>

                                <%# Note %>
                                <tr>
                                  <th>
                                    Note:
                                  </th>
                                  <td>
                                    <div style="padding: 4px 0px; min-height: 18px" class="field_group">

                                      <% related_person.person_note.each do |person_note| %>
                                          <div class="field_single" style="padding: 4px 0px">
                                            <%= person_note %>
                                          </div>
                                      <% end %>

                                    </div>
                                  </td>
                                </tr>

                                <tr>
                                  <th>
                                    Related Place:
                                  </th>
                                  <td>
                                    <div style="padding: 4px 0px; min-height: 18px" class="field_group">

                                      <% related_person.person_related_place.each do |related_place| %>
                                          <div class="field_single" style="padding: 4px 0px">
                                            <%= related_place %>
                                          </div>
                                      <% end %>

                                    </div>
                                  </td>
                                </tr>

                              </table>
                            </div>

                          </div>
                      <% end %>
                    </td>
                  </tr>

                  <%# Display Edit and Delete buttons %>
                  <tr>
                    <th colspan='2'>
                        <div class='edit_button'>
						  <%= button_to 'Edit', edit_entry_path(@entry), :method => :get, :class => 'buttonTo' %>
                          <%= button_to 'Delete', entry_path(@entry), :method => :delete, :class => 'buttonTo', :style => 'margin-left: 5px', :data => {:confirm => 'Are you sure you want to delete this entry?'} %>
						</div>
                    </th>
                  </tr>
                </table>
              </div>
            </div>
        <% end %>
        <div style='clear: both'></div>
      </div>

      <div style='clear: both'></div>

  <% end %>
</div>


