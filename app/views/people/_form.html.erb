
<div class="popup">

  <%
    if @person.new_record?
      start_text = 'Add'
      confirm_text = 'has been added'
      form_url = 'people_path(@person)'
      form_method = ':post'
    else
      start_text = 'Edit'
      confirm_text = 'has been updated'
      form_url = 'person_path(@person)'
      form_method = ':patch'
    end
  %>

  <div class="popup_title">
    <%= start_text %> <%= capitalize_first_letter(session[:person_list_type]) %>
  </div>

  <% if @person_name != nil && @person_name != '' %>
      <div id="popup_info" class="popup_info" style="display: none; text-align: center">
        '<%= @person_name %>'
        <%=confirm_text %>
      </div>
  <% end %>

  <% if @error != nil && @error != '' %>
      <div class="popup_error"><%= @error.html_safe %></div>
  <% end %>

  <div>
    <%= link_to 'Go back to search page', people_path, style: "font-style: italic" %>
  </div>

  <%= form_for @person, url: eval(form_url), method: eval(form_method), html: {style: 'margin-top: 15px; margin-bottom: 0px'} do |f| %>

      <div class='tab1'>

        <table cellspacing="0" style="width: 100%; font-size: 0.95em">

          <%# Family Name (Family) %>
          <tr>
            <th style="width: 150px">*Family Name:</th>
            <td>
              <%= text_field_tag "person[family]", @person.family %>
            </td>
          </tr>

          <%# Pre-Title %>
          <tr>
            <th>Pre-Title:</th>
            <td>
              <%= text_field_tag "person[pre_title]", @person.pre_title %>
            </td>
          </tr>

          <%# Given Name %>
          <tr>
            <th>Given Name:</th>
            <td>
              <%= text_field_tag "person[given_name]", @person.given_name %>
            </td>
          </tr>

          <%# Post_title %>
          <tr>
            <th>Post-Title:</th>
            <td>
              <%= text_field_tag "person[post_title]", @person.post_title %>
            </td>
          </tr>

          <%# Epithet %>
          <tr>
            <th>Epithet:</th>
            <td>
              <%= text_field_tag "person[epithet]", @person.epithet %>
            </td>
          </tr>

          <%# Same As %>
          <tr>
            <th>Same As:
              <img src="/assets/plus_sign.png" alt="plus icon" class="plus_icon click_popup_multiple_field_button" jq_type_1='person' jq_type_2="same_as"/>
            </th>
            <td>
              <div class="same_as">
                <% @person.same_as.each do |same_as| %>
                    <div class="field_single">
                      <%= text_field_tag 'person[same_as][]', same_as %>
                      <img alt="Delete icon" src="/assets/delete.png" class="delete_icon click_remove_field_level1" jq_tag_type="input">
                    </div>
                <% end %>
              </div>
            </td>
          </tr>

          <%# Related Authority %>
          <tr>
            <th>Related Authority:
              <img src="/assets/plus_sign.png" alt="plus icon" class="plus_icon click_popup_multiple_field_button" jq_type_1='person' jq_type_2="related_authority"/>
            </th>
            <td>
              <div class="field_group">
                <% @person.related_authority.each do |related_authority| %>
                    <div class="field_single">
                      <%= text_field_tag 'person[related_authority][]', related_authority %>
                      <img alt="Delete icon" src="/assets/delete.png" class="delete_icon click_remove_field_level1" jq_tag_type="input">
                    </div>
                <% end %>
              </div>
            </td>
          </tr>

          <%# Variant Names %>
          <%# Note that this is 'altlabel' in the model %>
          <tr>
            <th>Variant Names:
              <img src="/assets/plus_sign.png" alt="plus icon" class="plus_icon click_popup_multiple_field_button" jq_type_1='person' jq_type_2="altlabel"/>
            </th>
            <td>
              <div class="field_group">
                <% @person.altlabel.each do |altlabel| %>
                    <div class="field_single">
                      <%= text_field_tag 'person[altlabel][]', altlabel %>
                      <img alt="Delete icon" src="/assets/delete.png" class="delete_icon click_remove_field_level1" jq_tag_type="input">
                    </div>
                <% end %>
              </div>
            </td>
          </tr>

        </table>

        <%# Submit %>
        <p style="margin-top: 10px">
          <% if @person.new_record? %>
              <%= f.submit 'Submit' %>
              <%#= f.submit 'Submit and Close' %>
          <% else %>
              <%= f.submit 'Update' %>
          <% end %>
        </p>

      </div>

      <div style="clear: both"></div>


<% end %>

</div>
